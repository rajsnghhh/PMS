<button class="print-button" useExistingCss:boolean="true" printSectionId="printSection" ngxPrint>
  <img src="assets/icons/print.png" alt="">
</button>

<section id="printSection">
  <table role="presentation"
    style="width:100%;border-collapse:collapse; border:0; border-spacing:0;background:#ffffff;">
    <tr>
      <td align="center" style="padding:0;">
        <table role="presentation" cellspacing="0" cellpadding="0"
          style="width:900px;  border-collapse:collapse; border:1px solid #373737; border-spacing:0;text-align:left; margin-top: 20px;">

          <tr style="margin: 0px 0px; padding: 0px 0px;">
            <td colspan="2"
              style="text-align: center;color: #548235;font-size: 33px;font-weight: 600;padding: 15px 0px 5px 0px;">
              <table role="presentation" style="width:100%;border-collapse:collapse;border:0;border-spacing:0;">
                <tr style="background:#ffffff; border: transparent 1px solid;">
                  <td style="text-align: left;font-size: 15px;font-weight: 600;padding: 8px 8px;width:30%">
                    <img src="assets/Logo/infraLogo.png" style="height:59px; float: left;">
                  </td>
                  <td style="text-align: center;font-size: 15px;font-weight: 600;padding: 8px 8px;width:40%">
                    <div class="text1" style="color: #000; font-size: 19px;line-height: 31px;">
                      {{printData?.organization_details[0]?.name}}</div>
                    <div class="text2"
                      style="color: #000; font-size: 15px; font-weight: normal;line-height: 23px;">
                      {{printData?.site_details[0]?.site_name}}
                    </div>
                    <div class="text2"
                    style="color: #000; font-size: 15px; font-weight: normal;line-height: 23px;">
                    {{printData?.site_details[0]?.address}}
                  </div>
                  </td>
                  <td style="text-align: left;font-size: 15px;font-weight: 600;padding: 8px 8px;width:30%">
                    <div class="text1" style="color: #000; font-size: 17px; text-align: left; line-height: 31px;">
                      </div>
                    <div class="text2"
                      style="color: #000; font-size: 15px; font-weight: normal; text-align: left; line-height: 23px;">
                      <br>
                    </div>
                  </td>

                </tr>
              </table>
            </td>
          </tr>

          <tr style="margin: 0px 0px; padding: 0px 0px;">
            <td colspan="2"
              style="text-align: center;color: #548235;font-size: 33px;font-weight: 600;padding: 0px 0px 0px 0px;">
              <table role="presentation" style="width:100%;border-collapse:collapse;border:0;border-spacing:0;">

                <tr style="background:#ffffff; border: transparent 1px solid;">
                  <td colspan="3" style="text-align: center;font-size: 15px;font-weight: 600;padding: 8px 8px;">
                    <div class="text1" style="color: #000; font-size: 18px; text-align: center; line-height: 31px;">
                      MATERIAL REQUISITION</div>
                  </td>
                </tr>

                <tr style="background:#ffffff; border: transparent 1px solid;">
                  <td style="text-align: left;font-size: 15px;font-weight: 600;padding: 8px 8px;">
                    <div class="text1"
                      style="color: #000; font-size: 15px; text-align: left; font-weight: bold; line-height: 25px;">
                      <span style="width: 120px; float: left; ">Project Name : </span>{{printData?.project_name}}</div>
                    <div class="text1"
                      style="color: #000; font-size: 15px; text-align: left; font-weight: bold; line-height: 25px;">
                      <span style="width: 120px; float: left;">Requisition No. : </span>{{printData?.request_code}}</div>
                    <div class="text1"
                      style="color: #000; font-size: 15px; text-align: left; font-weight: bold; line-height: 25px;">
                      <span style="width: 120px; float: left;">MR Date :</span> {{printData?.date + ' '+printData?.time
                      | date : "MMM d, y h:mm:ss a"}}</div>

                  </td>
                  <td style="text-align: left;font-size: 15px;font-weight: 600;padding: 8px 8px;"></td>
                  <td style="text-align: left;font-size: 15px;font-weight: 600;padding: 8px 8px; float: right;">
                    <div class="text1"
                      style="color: #000; font-size: 15px; text-align: left; font-weight: bold; line-height: 25px;">
                      <span style="width: 143px; float: left;">Location :</span>{{printData?.location}}</div>
                    <div class="text1"
                      style="color: #000; font-size: 15px; text-align: left; font-weight: bold; line-height: 25px;">
                      <span style="width: 143px; float: left;">Requisition Date :</span>{{printData?.created_at | date :
                      "MMM d, y h:mm:ss a"}}</div>
                    <div class="text1"
                      style="color: #000; font-size: 15px; text-align: left; font-weight: bold; line-height: 25px;">
                      <span style="width: 143px; float: left;">Department Name :</span>
                      {{printData?.department_details[0]?.department}}
                    </div>
                  </td>
                </tr>
              </table>

            </td>
          </tr>

          <tr>
            <td colspan="2" style="padding:0px 0px 0px 0px;">
              <table role="presentation" style="width:100%;border-collapse:collapse;border:0;border-spacing:0;">
                <tr
                  style="background: #ddf2f3; border: #373737 1px solid; border-left: 0;  border-right: 0; height: 30px;">
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 13px; color: #000000;">
                    S.<br>
                    No.</td>
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 13px; color: #000000;">
                    Item<br>
                    code</td>
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 13px; color: #000000;max-width: 200px;">
                    Material Description</td>
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 13px; color: #000000;">
                    Material Spec.</td>
                    <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 13px; color: #000000;">
                    UOM</td>  

                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 13px; color: #000000;">
                    Req.<br>
                    Qty</td>
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 13px; color: #000000;">
                    Stock<br>
                    As on<br>
                    Date<br></td>
                
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 13px; color: #000000;">
                    Approved<br>
                    Qty.</td>
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 0px solid; font-weight: 600; font-size: 13px; color: #000000;">
                    Purpose</td>

                </tr>

                <tr *ngFor="let tableRow of printData?.requested_items; let i = index"
                  style="background: #ffffff; border: #373737 1px solid; border-left:0px ; border-right:0px ; height: 30px;">
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: normal; font-size: 12px; color: #000000;">
                    {{i+1}}</td>
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: normal; font-size: 12px; color: #000000;">
                    {{tableRow?.material_details?.material_code}}</td>
                  <td
                    style="text-align: center;padding: 4px;max-width: 200px; border-right:#373737 1px solid; font-weight: normal; font-size: 12px; color: #000000;">
                    <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal; word-break: break-all;">
                      Item : {{tableRow?.material_details?.material_name}}<br>
                      Type : {{tableRow?.material_details?.material_type_details[0]?.name}}<br>
                      Description :{{tableRow?.material_details?.material_descriptions}}<br>
                      <br>
                    </p>
                  </td>
                  
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: normal; font-size: 12px; color: #000000;">
                    {{tableRow?.size_part_grade}}</td>
                    <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 12px; color: #000000;">
                    <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;">
                      {{tableRow?.unit_of_mesurement_details[0]?.symbol}}</p>
                  </td>

                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: normal; font-size: 12px; color: #000000;">
                    <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;">
                      {{tableRow.quantity_unit}}</p>
                  </td>
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 12px; color: #000000;">
                    <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;">
                      {{tableRow?.stock_on_site}}</p>
                  </td>
                 
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 12px; color: #000000;">
                    <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;">
                      {{tableRow?.sanctioned_quantity}}</p>
                  </td>
                  <td
                    style="text-align: left;padding: 4px; border-right:#373737 0px solid; font-weight: 600; font-size: 12px; color: #000000;">
                    <p class="text-capitalize" style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;">
                      Remarks: {{printData.remarks}}</p>
                    <p class="text-capitalize" style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;">
                      Priority: {{tableRow.priority}}</p>
                    <p class="text-capitalize" style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;">
                      Required Date: {{tableRow.due_date | date : "MMM d, y"}}</p>
                    <p class="text-capitalize" style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;">
                      Charge Type: {{tableRow.charge_type}}</p>
                  </td>
                </tr>
                <tr style="background: #ffffff; border: #373737 1px solid; border-right: 0; height: 30px;">
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 12px; color: #000000; vertical-align: top;">
                    <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;"></p>
                  </td>
                  <td colspan="2"
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 12px; color: #000000; vertical-align: top;">
                    <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;"></p>
                  </td>
                  <td
                  style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 12px; color: #000000;">
                  <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;"></p>
                </td>
                  <td
                    style="text-align: right;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 12px; color: #000000; ">
                    <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: bold;">Total</p>
                  </td>
                  <td
                    style="text-align:center; padding: 4px; border-right:#373737 1px solid; font-weight: normal; font-size: 12px; color: #000000;">
                    {{printData?.total_req_item_qty}}</td>

                 
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 12px; color: #000000;">
                    <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;"></p>
                  </td>
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 1px solid; font-weight: 600; font-size: 12px; color: #000000; ">
                    <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;"></p>
                  </td>
                  <td
                    style="text-align: center;padding: 4px; border-right:#373737 0px solid; font-weight: 600; font-size: 12px; color: #000000;">
                    <p style="padding: 0px 0px; margin: 0px 0px 5px 0px; font-weight: normal;"></p>
                  </td>
                </tr>

              </table><br>

              <div class="text1"
                style="color: #000; font-size: 15px; text-align: left; font-weight: bold; line-height: 25px;"><span
                  style="width: 70px; float: left;">Remarks :</span> {{printData?.line_in_bottom}}</div>
            </td>
          </tr>

          <tr>
            <td colspan="2" style="padding:0px 0px;">
              <table role="presentation" style="width:100%;border-collapse:collapse;border:0;border-spacing:0;">
                <tr style="background:#ffffff; border: transparent 1px solid;">

                  <td colspan="4" style="text-align: left;font-size: 15px;font-weight: 600;padding: 8px 0px;">
                    <div class="text1" style="color: #000;margin: auto;width: 90%; font-size: 13px; text-align: left; font-weight: bold; line-height: 25px; display: flex;margin-top: 50px;
                      align-items: center;
                      justify-content: space-between;
                      gap: 15px; padding: 0px 12px;">
                      <a *ngIf="printData?.created_by_name"  style="color: #000; text-decoration: none;">{{printData?.created_by_name}}</a>
                      <a *ngIf="!printData?.created_by_name" style="color: #000; text-decoration: none;"></a>

                      <a *ngIf="printData?.requested_items[0]?.checked_by_details"
                        style="color: #000; text-decoration: none;">{{printData?.requested_items[0]?.checked_by_details[0]?.first_name
                        + " " + printData?.requested_items[0]?.checked_by_details[0]?.last_name}}</a>
                        <a *ngIf="!printData?.requested_items[0]?.checked_by_details"
                        style="color: #000; text-decoration: none;"></a>  
                      <a  *ngIf="printData?.requested_items[0]?.approved_by_details"
                        style="color: #000; text-decoration: none;">{{printData?.requested_items[0]?.approved_by_details[0]?.first_name
                        + " " + printData?.requested_items[0]?.approved_by_details[0]?.last_name}}</a>
                        <a  *ngIf="!printData?.requested_items[0]?.approved_by_details"
                        style="color: #000; text-decoration: none;"></a>  
                    </div>
                  </td>
                </tr>

                <tr style="background:#ffffff; border: transparent 1px solid; margin-top: 22px;">
                  <td colspan="4" style="text-align: left;font-size: 15px;font-weight: 600;padding: 8px 0px;">
                    <div class="text1" style="color: #000; font-size: 13px; text-align: left; font-weight: bold; line-height: 25px; display: flex;
                      align-items: center;
                      justify-content: space-between;
                      gap: 15px; padding: 0px 12px;">
                      <a href="#" style="color: #000; text-decoration: none; border-top: #000 1px solid;">Requested By -
                        Name & sign</a>
                      <a href="#" style="color: #000; text-decoration: none; border-top: #000 1px solid;">Checked By -
                        Name & sign</a>
                      <a href="#" style="color: #000; text-decoration: none; border-top: #000 1px solid;">Approved By -
                        Name & sign</a>
                    </div>
                  </td>
                </tr>
              </table>
            </td>
          </tr>



        </table>
      </td>


    </tr>
  </table>
</section>